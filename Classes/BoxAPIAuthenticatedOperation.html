<!DOCTYPE HTML>
<html>
	<head>
		<meta http-equiv="Content-Type" content="html/html; charset=utf-8" />
		<title>BoxAPIAuthenticatedOperation Class Reference</title>
		<meta id="xcode-display" name="xcode-display" content="render"/>
		<link rel="stylesheet" type="text/css" href="../css/styles.css" media="all" />
		<link rel="stylesheet" type="text/css" media="print" href="../css/stylesPrint.css" />
		<meta name="generator" content="appledoc 2.1 (build 858)" />
	</head>
	<body>
		<header id="top_header">
			<div id="library" class="hideInXcode">
				<h1><a id="libraryTitle" href="../index.html">BoxSDK and BoxCocoaSDK </a></h1>
				<a id="developerHome" href="../index.html">Box</a>
			</div>
			
			<div id="title" role="banner">
				<h1 class="hideInXcode">BoxAPIAuthenticatedOperation Class Reference</h1>
			</div>
			<ul id="headerButtons" role="toolbar">
				<li id="toc_button">
					<button aria-label="Show Table of Contents" role="checkbox" class="open" id="table_of_contents"><span class="disclosure"></span>Table of Contents</button>
				</li>
				<li id="jumpto_button" role="navigation">
					<select id="jumpTo">
	<option value="top">Jump To&#133;</option>
	
	<option value="overview">Overview</option>
	
	
	
	
	<option value="tasks">Tasks</option>
	
	
	
	
	
	<option value="properties">Properties</option>
	
	<option value="//api/name/timesReenqueued">&nbsp;&nbsp;&nbsp;&nbsp;timesReenqueued</option>
	
	
	
	
	
	
	<option value="instance_methods">Instance Methods</option>
	
	<option value="//api/name/handleExpiredOAuth2Token">&nbsp;&nbsp;&nbsp;&nbsp;- handleExpiredOAuth2Token</option>
	
	<option value="//api/name/initWithURL:HTTPMethod:body:queryParams:OAuth2Session:">&nbsp;&nbsp;&nbsp;&nbsp;- initWithURL:HTTPMethod:body:queryParams:OAuth2Session:</option>
	
	<option value="//api/name/isOAuth2TokenExpired">&nbsp;&nbsp;&nbsp;&nbsp;- isOAuth2TokenExpired</option>
	
	<option value="//api/name/prepareAPIRequest">&nbsp;&nbsp;&nbsp;&nbsp;- prepareAPIRequest</option>
	
	
	
</select>
				</li>
			</ul>
		</header>
		<nav id="tocContainer" class="isShowingTOC">
			<ul id="toc" role="tree">
				
<li role="treeitem"><span class="nodisclosure"></span><span class="sectionName"><a href="#overview">Overview</a></span></li>




<li role="treeitem" id="task_treeitem"><span class="nodisclosure"></span><span class="sectionName"><a href="#tasks">Tasks</a></span><ul>
	
	<li><span class="nodisclosure"></span><span class="sectionName"><a href="#task_OAuth2 expiration and refresh">OAuth2 expiration and refresh</a></span></li>
	
	<li><span class="nodisclosure"></span><span class="sectionName"><a href="#task_Request signing">Request signing</a></span></li>
	
</ul></li>





<li role="treeitem" class="children"><span class="disclosure"></span><span class="sectionName"><a href="#properties">Properties</a></span><ul>
	
	<li><span class="nodisclosure"></span><span class="sectionName"><a href="#//api/name/timesReenqueued">timesReenqueued</a></span></li>
	
</ul></li>





<li role="treeitem" class="children"><span class="disclosure"></span><span class="sectionName"><a href="#instance_methods">Instance Methods</a></span><ul>
	
	<li><span class="nodisclosure"></span><span class="sectionName"><a href="#//api/name/handleExpiredOAuth2Token">handleExpiredOAuth2Token</a></span></li>
	
	<li><span class="nodisclosure"></span><span class="sectionName"><a href="#//api/name/initWithURL:HTTPMethod:body:queryParams:OAuth2Session:">initWithURL:HTTPMethod:body:queryParams:OAuth2Session:</a></span></li>
	
	<li><span class="nodisclosure"></span><span class="sectionName"><a href="#//api/name/isOAuth2TokenExpired">isOAuth2TokenExpired</a></span></li>
	
	<li><span class="nodisclosure"></span><span class="sectionName"><a href="#//api/name/prepareAPIRequest">prepareAPIRequest</a></span></li>
	
</ul></li>


			</ul>
		</nav>
		<article>
			<div id="contents" class="isShowingTOC" role="main">
				<a title="BoxAPIAuthenticatedOperation Class Reference" name="top"></a>
				<div class="main-navigation navigation-top">
					<ul>
	<li><a href="../index.html">Index</a></li>
	<li><a href="../hierarchy.html">Hierarchy</a></li>
</ul>
				</div>
				<div id="header">
					<div class="section-header">
						<h1 class="title title-header">BoxAPIAuthenticatedOperation Class Reference</h1>
					</div>		
				</div>
				<div id="container">	
					
					<div class="section section-specification"><table cellspacing="0"><tbody>
						<tr>
	<td class="specification-title">Inherits from</td>
	<td class="specification-value"><a href="../Classes/BoxAPIOperation.html">BoxAPIOperation</a> : NSOperation</td>
</tr><tr>
	<td class="specification-title">Declared in</td>
	<td class="specification-value">BoxAPIAuthenticatedOperation.h<br />BoxAPIAuthenticatedOperation.m</td>
</tr>
						</tbody></table></div>
					
					
					
					
					<div class="section section-overview">
						<a title="Overview" name="overview"></a>
						<h2 class="subtitle subtitle-overview">Overview</h2>
						<p>BoxAPIAuthenticatedOperation is an abstract base class for all API operations that
require authentication with Box. Because this class is abstract, you should not instantiate
it directly. Instead, use one of its subclasses:</p>

<ul>
<li><a href="../Classes/BoxAPIJSONOperation.html">BoxAPIJSONOperation</a></li>
<li><a href="../Classes/BoxAPIMultipartToJSONOperation.html">BoxAPIMultipartToJSONOperation</a></li>
<li><a href="../Classes/BoxAPIDataOperation.html">BoxAPIDataOperation</a></li>
</ul>


<p>This class encapsulates logic for handling expired access tokens. If an access token is found
to be expired, instances will request an attempt to refresh the OAuth2 tokens and will attempt
to reenqueue the failed operation.</p>

<h1>Error Conditions</h1>

<p>&hellip;</p><div class="warning"><p><strong>Warning:</strong> Only members of the class <a href="../Classes/BoxAPIJSONOperation.html">BoxAPIJSONOperation</a> may be reenqueued. Neither
<a href="../Classes/BoxAPIMultipartToJSONOperation.html">BoxAPIMultipartToJSONOperation</a> nor <a href="../Classes/BoxAPIDataOperation.html">BoxAPIDataOperation</a> instances may be reenqueued because they
contain properties that cannot be copied (subclasses of NSStream).</p></div>
					</div>
					
					
					
					
					
					<div class="section section-tasks">
						<a title="Tasks" name="tasks"></a>
						<h2 class="subtitle subtitle-tasks">Tasks</h2>
						
						
						<a title="OAuth2 expiration and refresh" name="task_OAuth2 expiration and refresh"></a>
						<h3 class="subsubtitle task-title">OAuth2 expiration and refresh</h3>

						<ul class="task-list">
							<li>
	<span class="tooltip">
		<code><a href="#//api/name/timesReenqueued">&nbsp;&nbsp;timesReenqueued</a></code>
		<span class="tooltip"><p>The number of times an operation has been reenqueued. This class
will only attempt to reenqueue failed operations once before failing
permanenetly.</p></span>
	</span>
	<span class="task-item-suffix">property</span>
	
</li><li>
	<span class="tooltip">
		<code><a href="#//api/name/isOAuth2TokenExpired">&ndash;&nbsp;isOAuth2TokenExpired</a></code>
		<span class="tooltip"><p>Checks for the presense of a WWW-Authenticate header with the error reason
<code>error="invalid_token"</code> which indicates that the token is invalid and potentially expired.</p></span>
	</span>
	
	
</li><li>
	<span class="tooltip">
		<code><a href="#//api/name/handleExpiredOAuth2Token">&ndash;&nbsp;handleExpiredOAuth2Token</a></code>
		<span class="tooltip"><p>Have <a href="../Classes/BoxAPIOperation.html#//api/name/OAuth2Session">self.OAuth2Session</a> issue a <a href="../Classes/BoxAPIOAuth2ToJSONOperation.html">BoxAPIOAuth2ToJSONOperation</a>
to refresh the access token.</p></span>
	</span>
	
	
</li>
						</ul>
						
						
						<a title="Request signing" name="task_Request signing"></a>
						<h3 class="subsubtitle task-title">Request signing</h3>

						<ul class="task-list">
							<li>
	<span class="tooltip">
		<code><a href="#//api/name/prepareAPIRequest">&ndash;&nbsp;prepareAPIRequest</a></code>
		<span class="tooltip"><p>Modify <a href="../Classes/BoxAPIOperation.html#//api/name/APIRequest">self.APIRequest</a> to contain authentication information
in the form of an Authorization header with a Bearer token.</p></span>
	</span>
	
	
</li>
						</ul>
						
						
						
						<h3 class="subsubtitle task-title">Other Methods</h3>

						<ul class="task-list">
							<li>
	<span class="tooltip">
		<code><a href="#//api/name/initWithURL:HTTPMethod:body:queryParams:OAuth2Session:">&ndash;&nbsp;initWithURL:HTTPMethod:body:queryParams:OAuth2Session:</a></code>
		<span class="tooltip"><p>Designated initializer. This initializer sets up <a href="../Classes/BoxAPIOperation.html#//api/name/APIRequest">APIRequest</a> based on its input parameters</p></span>
	</span>
	
	
</li>
						</ul>
						
					</div>
					
					
					
					
					
					<div class="section section-methods">
						<a title="Properties" name="properties"></a>
						<h2 class="subtitle subtitle-methods">Properties</h2>
						
						<div class="section-method">
	<a name="//api/name/timesReenqueued" title="timesReenqueued"></a>
	<h3 class="subsubtitle method-title">timesReenqueued</h3>
	
	
	
	<div class="method-subsection brief-description">
		<p>The number of times an operation has been reenqueued. This class
will only attempt to reenqueue failed operations once before failing
permanenetly.</p>
	</div>		
	
    

	<div class="method-subsection method-declaration"><code>@property (nonatomic, readwrite, assign) NSUInteger timesReenqueued</code></div>

    
	
	
	
	
	
	
	
	<div class="method-subsection discussion-section">
		<h4 class="method-subtitle">Discussion</h4>
		<p>The number of times an operation has been reenqueued. This class
will only attempt to reenqueue failed operations once before failing
permanenetly.</p>
	</div>
	
	
	
	
	
	<div class="method-subsection see-also-section">
		<h4 class="method-subtitle">See Also</h4>
		<ul>
			
			<li><code><p><a href="#//api/name/handleExpiredOAuth2Token">- handleExpiredOAuth2Token</a></p></code></li>
			
			<li><code><p><a href="#//api/name/connection:didReceiveResponse:">- connection:didReceiveResponse:</a></p></code></li>
			
		</ul>
	</div>
	
	
	
	<div class="method-subsection declared-in-section">
		<h4 class="method-subtitle">Declared In</h4>
		<code class="declared-in-ref">BoxAPIAuthenticatedOperation.h</code><br />
	</div>				
	
	
</div>
						
					</div>
					
					
					
					
					
					<div class="section section-methods">
						<a title="Instance Methods" name="instance_methods"></a>
						<h2 class="subtitle subtitle-methods">Instance Methods</h2>
						
						<div class="section-method">
	<a name="//api/name/handleExpiredOAuth2Token" title="handleExpiredOAuth2Token"></a>
	<h3 class="subsubtitle method-title">handleExpiredOAuth2Token</h3>
	
	
	
	<div class="method-subsection brief-description">
		<p>Have <a href="../Classes/BoxAPIOperation.html#//api/name/OAuth2Session">self.OAuth2Session</a> issue a <a href="../Classes/BoxAPIOAuth2ToJSONOperation.html">BoxAPIOAuth2ToJSONOperation</a>
to refresh the access token.</p>
	</div>		
	
    

	<div class="method-subsection method-declaration"><code>- (void)handleExpiredOAuth2Token</code></div>

    
	
	
	
	
	
	
	
	<div class="method-subsection discussion-section">
		<h4 class="method-subtitle">Discussion</h4>
		<p>Have <a href="../Classes/BoxAPIOperation.html#//api/name/OAuth2Session">self.OAuth2Session</a> issue a <a href="../Classes/BoxAPIOAuth2ToJSONOperation.html">BoxAPIOAuth2ToJSONOperation</a>
to refresh the access token.</p>
	</div>
	
	
	
	
	
	
	
	<div class="method-subsection declared-in-section">
		<h4 class="method-subtitle">Declared In</h4>
		<code class="declared-in-ref">BoxAPIAuthenticatedOperation.h</code><br />
	</div>				
	
	
</div>
						
						<div class="section-method">
	<a name="//api/name/initWithURL:HTTPMethod:body:queryParams:OAuth2Session:" title="initWithURL:HTTPMethod:body:queryParams:OAuth2Session:"></a>
	<h3 class="subsubtitle method-title">initWithURL:HTTPMethod:body:queryParams:OAuth2Session:</h3>
	
	
	
	<div class="method-subsection brief-description">
		<p>Designated initializer. This initializer sets up <a href="../Classes/BoxAPIOperation.html#//api/name/APIRequest">APIRequest</a> based on its input parameters</p>
	</div>		
	
    

	<div class="method-subsection method-declaration"><code>- (id)initWithURL:(NSURL *)<em>URL</em> HTTPMethod:(NSString *)<em>HTTPMethod</em> body:(NSDictionary *)<em>body</em> queryParams:(NSDictionary *)<em>queryParams</em> OAuth2Session:(BoxOAuth2Session *)<em>OAuth2Session</em></code></div>

    
	
	<div class="method-subsection arguments-section parameters">
		<h4 class="method-subtitle parameter-title">Parameters</h4>
		
		<dl class="argument-def parameter-def">
			<dt><em>URL</em></dt>
			<dd><p>the <a href="../Classes/BoxAPIOperation.html#//api/name/baseRequestURL">baseRequestURL</a></p></dd>
		</dl>
		
		<dl class="argument-def parameter-def">
			<dt><em>HTTPMethod</em></dt>
			<dd><p>one of GET, POST, PUT, DELETE, OPTIONS. Used to configure <a href="../Classes/BoxAPIOperation.html#//api/name/APIRequest">APIRequest</a></p></dd>
		</dl>
		
		<dl class="argument-def parameter-def">
			<dt><em>body</em></dt>
			<dd><p>Key value pairs to be encoded as the request <a href="../Classes/BoxAPIOperation.html#//api/name/body">body</a></p></dd>
		</dl>
		
		<dl class="argument-def parameter-def">
			<dt><em>queryParams</em></dt>
			<dd><p>Key value pairs to be encoded as part of the query string</p></dd>
		</dl>
		
		<dl class="argument-def parameter-def">
			<dt><em>OAuth2Session</em></dt>
			<dd><p>used for signing requests</p></dd>
		</dl>
		
	</div>
	
	
	
	<div class="method-subsection return">
		<h4 class="method-subtitle parameter-title">Return Value</h4>
		<p>An initialized BoxAPIOperation</p>
	</div>
	
	
	
	
	
	<div class="method-subsection discussion-section">
		<h4 class="method-subtitle">Discussion</h4>
		<p>Designated initializer. This initializer sets up <a href="../Classes/BoxAPIOperation.html#//api/name/APIRequest">APIRequest</a> based on its input parameters</p>
	</div>
	
	
	
	
	
	
	
	<div class="method-subsection declared-in-section">
		<h4 class="method-subtitle">Declared In</h4>
		<code class="declared-in-ref">BoxAPIOperation.h</code><br />
	</div>				
	
	
</div>
						
						<div class="section-method">
	<a name="//api/name/isOAuth2TokenExpired" title="isOAuth2TokenExpired"></a>
	<h3 class="subsubtitle method-title">isOAuth2TokenExpired</h3>
	
	
	
	<div class="method-subsection brief-description">
		<p>Checks for the presense of a WWW-Authenticate header with the error reason
<code>error="invalid_token"</code> which indicates that the token is invalid and potentially expired.</p>
	</div>		
	
    

	<div class="method-subsection method-declaration"><code>- (BOOL)isOAuth2TokenExpired</code></div>

    
	
	
	
	<div class="method-subsection return">
		<h4 class="method-subtitle parameter-title">Return Value</h4>
		<p>A BOOL indicating if the token is expired.</p>
	</div>
	
	
	
	
	
	<div class="method-subsection discussion-section">
		<h4 class="method-subtitle">Discussion</h4>
		<p>Checks for the presense of a WWW-Authenticate header with the error reason
<code>error="invalid_token"</code> which indicates that the token is invalid and potentially expired.</p>
	</div>
	
	
	
	
	
	
	
	<div class="method-subsection declared-in-section">
		<h4 class="method-subtitle">Declared In</h4>
		<code class="declared-in-ref">BoxAPIAuthenticatedOperation.h</code><br />
	</div>				
	
	
</div>
						
						<div class="section-method">
	<a name="//api/name/prepareAPIRequest" title="prepareAPIRequest"></a>
	<h3 class="subsubtitle method-title">prepareAPIRequest</h3>
	
	
	
	<div class="method-subsection brief-description">
		<p>Modify <a href="../Classes/BoxAPIOperation.html#//api/name/APIRequest">self.APIRequest</a> to contain authentication information
in the form of an Authorization header with a Bearer token.</p>
	</div>		
	
    

	<div class="method-subsection method-declaration"><code>- (void)prepareAPIRequest</code></div>

    
	
	
	
	
	
	
	
	<div class="method-subsection discussion-section">
		<h4 class="method-subtitle">Discussion</h4>
		<p>Modify <a href="../Classes/BoxAPIOperation.html#//api/name/APIRequest">self.APIRequest</a> to contain authentication information
in the form of an Authorization header with a Bearer token.</p>

<p>This is delayed as long as possible to ensure that the OAuth2
session is not stale by the time this operation makes it through
whatever queue it is in.</p>
	</div>
	
	
	
	
	
	<div class="method-subsection see-also-section">
		<h4 class="method-subtitle">See Also</h4>
		<ul>
			
			<li><code><p><a href="../Classes/BoxOAuth2Session.html#//api/name/addAuthorizationParametersToRequest:">[BoxOAuth2Session addAuthorizationParametersToRequest:]</a></p></code></li>
			
		</ul>
	</div>
	
	
	
	<div class="method-subsection declared-in-section">
		<h4 class="method-subtitle">Declared In</h4>
		<code class="declared-in-ref">BoxAPIAuthenticatedOperation.h</code><br />
	</div>				
	
	
</div>
						
					</div>
					
					
				</div>
				<div class="main-navigation navigation-bottom">
					<ul>
	<li><a href="../index.html">Index</a></li>
	<li><a href="../hierarchy.html">Hierarchy</a></li>
</ul>
				</div>
				<div id="footer">
					<hr />
					<div class="footer-copyright">
						<p><span class="copyright">&copy; 2013 Box. All rights reserved. (Last updated: 2013-11-21)</span><br />
						
						<span class="generator">Generated by <a href="http://appledoc.gentlebytes.com">appledoc 2.1 (build 858)</a>.</span></p>
						
					</div>
				</div>
			</div>
		</article>
		<script type="text/javascript">
			function jumpToChange()
			{
				window.location.hash = this.options[this.selectedIndex].value;
			}
			
			function toggleTOC()
			{
				var contents = document.getElementById('contents');
				var tocContainer = document.getElementById('tocContainer');
				
				if (this.getAttribute('class') == 'open')
				{
					this.setAttribute('class', '');
					contents.setAttribute('class', '');
					tocContainer.setAttribute('class', '');
					
					window.name = "hideTOC";
				}
				else
				{
					this.setAttribute('class', 'open');
					contents.setAttribute('class', 'isShowingTOC');
					tocContainer.setAttribute('class', 'isShowingTOC');
					
					window.name = "";
				}
				return false;
			}
			
			function toggleTOCEntryChildren(e)
			{
				e.stopPropagation();
				var currentClass = this.getAttribute('class');
				if (currentClass == 'children') {
					this.setAttribute('class', 'children open');
				}
				else if (currentClass == 'children open') {
					this.setAttribute('class', 'children');
				}
				return false;
			}
			
			function tocEntryClick(e)
			{
				e.stopPropagation();
				return true;
			}
			
			function init()
			{
				var selectElement = document.getElementById('jumpTo');
				selectElement.addEventListener('change', jumpToChange, false);
				
				var tocButton = document.getElementById('table_of_contents');
				tocButton.addEventListener('click', toggleTOC, false);
				
				var taskTreeItem = document.getElementById('task_treeitem');
				if (taskTreeItem.getElementsByTagName('li').length > 0)
				{
					taskTreeItem.setAttribute('class', 'children');
					taskTreeItem.firstChild.setAttribute('class', 'disclosure');
				}
				
				var tocList = document.getElementById('toc');
				
				var tocEntries = tocList.getElementsByTagName('li');
				for (var i = 0; i < tocEntries.length; i++) {
					tocEntries[i].addEventListener('click', toggleTOCEntryChildren, false);
				}
				
				var tocLinks = tocList.getElementsByTagName('a');
				for (var i = 0; i < tocLinks.length; i++) {
					tocLinks[i].addEventListener('click', tocEntryClick, false);
				}
				
				if (window.name == "hideTOC") {
					toggleTOC.call(tocButton);
				}
			}
			
			window.onload = init;
			
			// If showing in Xcode, hide the TOC and Header
			if (navigator.userAgent.match(/xcode/i)) {
				document.getElementById("contents").className = "hideInXcode"
				document.getElementById("tocContainer").className = "hideInXcode"
				document.getElementById("top_header").className = "hideInXcode"
			}
			
		</script>
	</body>
</html>